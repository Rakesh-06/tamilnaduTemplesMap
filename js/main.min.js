function initMap(){var e=[{elementType:"geometry",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.stroke",stylers:[{color:"#F7F4F3"}]},{elementType:"labels.text.fill",stylers:[{color:"#D24A06"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#CB7C0A"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#FB05BC"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#CD5F4D"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#FB05BC"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#B398BD"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{color:"#ACC929"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#FB05BC"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#ACC929"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#B398BD"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#6D0808"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#919354"}]},{featureType:"transit.station",elementType:"labels.text.fill",stylers:[{color:"#6D0808"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#9EC2CD"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#FB05BC"}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{color:"#F7F4F3"}]}];map=new google.maps.Map(document.getElementById("map"),{center:{lat:9.952168,lng:78.125244},zoom:16,styles:e}),templeInfowindow=new google.maps.InfoWindow;for(var t=makeMarkerIcon("03FB96"),a=makeMarkerIcon("FBBF03"),o=0;o<templesData.length;o++){var l=templesData[o].location,r=templesData[o].title;marker=new google.maps.Marker({map:map,position:l,title:r,icon:t,animation:google.maps.Animation.DROP}),templesData[o].eachTempleMarker=marker,marker.addListener("click",function(){populateInfoWindow(this,templeInfowindow)}),marker.addListener("mouseover",function(){this.setIcon(a)}),marker.addListener("mouseout",function(){this.setIcon(t)})}}function populateInfoWindow(e,t){var a="http://en.wikipedia.org/w/api.php?action=opensearch&search="+e.title+"&format=json&callback=wikiCallback";$.ajax(a,{dataType:"jsonp"}).done(function(a){function o(a,o){if(o==google.maps.StreetViewStatus.OK){var l=a.location.latLng,n=google.maps.geometry.spherical.computeHeading(l,e.position);t.setContent("<div>"+e.title+'<br> <a href="'+r+'">Click here! Know the HOLY LAND</a></div><div id="pano"></div>');var i={position:l,pov:{heading:n,pitch:45}};new google.maps.StreetViewPanorama(document.getElementById("pano"),i)}else t.setContent("<div>"+e.title+'<br> <a href="'+r+'">Click here! Know the HOLY LAND</a></div><div>Sorry FRIEND...... No Street View Found!</div>')}var l=a[0],r="http://en.wikipedia.org/wiki/"+l;if(t.marker!=e){t.marker=e,e.addListener("click",toggleBounce(e)),t.setContent("<div>"+e.title+'<br> <a href="'+r+'">Click here! Know the HOLY LAND</a></div>'),t.addListener("closeclick",function(){});var n=new google.maps.StreetViewService,i=100;n.getPanoramaByLocation(e.position,i,o),t.open(map,e)}}).fail(function(e,t){alert("Some Problem caused Request to Fail...... Check it!")})}function makeMarkerIcon(e){var t=new google.maps.MarkerImage("http://chart.googleapis.com/chart?chst=d_map_spin&chld=1.15|0|"+e+"|40|_|%E2%80%A2",new google.maps.Size(21,34),new google.maps.Point(0,0),new google.maps.Point(10,34),new google.maps.Size(21,34));return t}function toggleBounce(e){null!==e.getAnimation()?e.setAnimation(null):(e.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){e.setAnimation(null)},1e3))}var templesData=[{title:"Annamalaiyar Temple",location:{lat:12.231646,lng:79.06774}},{title:"Brihadeeswara Temple",location:{lat:10.782783,lng:79.131846}},{title:"Kanchi Kailasanathar Temple",location:{lat:13.033634,lng:80.270199}},{title:"Meenakshi Amman Temple",location:{lat:9.919505,lng:78.119342}},{title:"Nellaiappar Temple",location:{lat:8.728368,lng:77.688594}},{title:"Ramanathaswamy Temple",location:{lat:9.288114,lng:79.317392}},{title:"Amritaghateswarar-Abirami Temple,Thirukkadaiyur",location:{lat:11.074841,lng:79.806736}},{title:"Sri Ranganathaswamy Temple, Srirangam",location:{lat:10.862043,lng:78.690218}},{title:"Thillai Nataraja Temple, Chidambaram",location:{lat:11.399296,lng:79.693548}},{title:"Thyagaraja Temple, Tiruvarur",location:{lat:10.77608,lng:79.633034}}],map,marker,templeInfowindow,googleError=function(){alert("Sorry....... Something went wrong.......Try Reconnecting some time later.....")},TempleViewModel=function(){var e=this;e.templesData=ko.observable(templesData),e.clickOver=function(e){map.setZoom(20),map.setCenter(e.location),populateInfoWindow(e.eachTempleMarker,templeInfowindow)},e.filterInput=ko.observable(""),e.filterTemple=ko.computed(function(){var t=ko.utils.arrayFilter(e.templesData(),function(t){var a=t.title.toLowerCase(),o=e.filterInput().toLowerCase(),l=t.eachTempleMarker;return a.indexOf(o)>=0?(l&&l.setVisible(!0),!0):(l&&l.setVisible(!1),!1)});return t})};ko.applyBindings(new TempleViewModel);
